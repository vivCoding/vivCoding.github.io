<!doctype html><html lang="en" class="motion-reduce:scroll-auto scroll-smooth"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="robots" content="index, follow"><meta property="og:type" content="website"><meta property="og:title" content="Back to basics: Neural network from scratch | Vincent V"><meta property="og:url" content="https://vivcoding.github.io"><meta property="og:image" content="/up_/assets/images/logo-bg.png"><meta property="og:description" content="For one of my classes, I had to implement a neural network from scratch. It was a great refresher on the math behind a neural network. Though, that doesn't make..."><meta property="twitter:title" content="Back to basics: Neural network from scratch | Vincent V"><meta property="twitter:description" content="For one of my classes, I had to implement a neural network from scratch. It was a great refresher on the math behind a neural network. Though, that doesn't make..."><meta property="twitter:image" content="/assets/images/logo-bg.png"><meta name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/blog/index.183d13f7.css"><link rel="stylesheet" href="/blog/2024-01-12_hello-world/index.964072a6.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="icon shortcut" type="image/x-icon" href="/logo-bg.02c4c481.svg"><title> Back to basics: Neural network from scratch | Vincent V </title></head><style>.katex-display{flex-direction:row;justify-content:center;align-items:center;display:flex}</style><body class="bg-zinc-900 font-sans text-white"> <main class="max-w-4xl mb-10 mx-auto my-4 px-10"> <nav class="mb-10"> <div class="flex flex-row flex-wrap items-center justify-center space-x-4"> <h4 class="font-bold text-center text-lg">Vincent V</h4> <div class="bg-white rounded self-stretch w-[2px]"></div> <a class="border-b-2 border-b-transparent border-solid duration-200 flex flex-row font-semibold hover:border-b-white hover:opacity-60 items-center text-sm transition w-fit" href="/" title="Home"> <svg class="fill-white" height="1em" viewBox="0 0 576 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"/></svg> &nbsp; <span>Home</span> </a> <a class="border-b-2 border-b-transparent border-solid duration-200 flex flex-row font-semibold hover:border-b-white hover:opacity-60 items-center text-sm transition w-fit" href="/blog" title="Blog"> <svg class="fill-white" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="m410.3 231 11.3-11.3-33.9-33.9-62.1-62.1-33.9-33.9-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2l199.2-199.2 22.6-22.7zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9l-78.2 23 23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7l-14.4 14.5-22.6 22.6-11.4 11.3 33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5l-39.3-39.4c-25-25-65.5-25-90.5 0zm-47.4 168-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"/></svg> &nbsp; <span>Blog</span> </a> </div> </nav> <div id="postHeader"> <h1 class="break-words font-bold hyphens-auto mb-0 text-5xl"> Back to basics: Neural network from scratch </h1> <h6 class="italic mt-4 text-sm"> Created: <span class="font-light"> Feb 03, 2024 </span> </h6> <h6 class="italic text-sm"> Updated: <span class="font-light"> Feb 03, 2024 </span> </h6> </div> <div class="border-solid border-y-2 border-y-white max-w-none mt-10 prose prose-invert py-4"> <p>For one of my classes, I had to implement a neural network from scratch. It was a great refresher on the math behind a neural network. Though, that doesn't make implementing and visualizing the math easier.</p> <blockquote> <p>&quot;You're good in math bro, you should learn machine learning bro&quot;</p> </blockquote> <img src="https://media1.tenor.com/m/-URYSckgL9sAAAAd/get-out-of-my-head-meme.gif" alt="cat crazy like me fr" width="200"> <p>I write this to remind my future self on the intuition behind the math in the neural network, in case I want a refresher, or if I ever have to write a neural network from scratch again (when pigs start flying). I won't be discussing what each layer does or why we use certain layers, per se. I wanted to show how we derived the forward and backward passes (<em>especially</em> the backward pass).</p> <h2>Setup</h2> <p>The model we'll describe will be a classification model. It takes in input(s), and outputs a probability distribution describing how likely it is to be a specific class. It will consist of the following layers, in order:</p> <ol> <li>Linear</li> <li>ReLU</li> <li>Softmax</li> </ol> <p>For our loss function, we'll use the negative log likelihood (NLL) function.</p> <blockquote> <p><strong>PLEASE NOTE</strong> that this is for learning purposes. In practice, depending on what you want (say for classification), you may not want ReLU as the last layer.</p> </blockquote> <blockquote> <p>For classification, the cross entropy loss is equivalent to having a softmax layer and using NLL loss. So, you can simplify softmax and NLL loss to be the cross entropy loss function. However, I prefer to keep them separate to make math easier to grasp.</p> </blockquote> <p>Typically, most guides describe the input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> to the model as a vector with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> input features. However, we usually train over multiple examples (a batch size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span>). Thus, in this guide, we'll define our input to our model as a matrix with dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row in the input is one training example.</p> <p>Similarly, our model output will be a <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> matrix, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> represents the number of output features (the number of classes we can predict).</p> <p>With the model's core dimensions defined, let's dive into the specifics of each layer and the forward pass of the neural network.</p> <blockquote> <p>Note, I'll define variables that are probably not very common in other tutorials. Idc. These variables made sense to me when I was first learning it.</p> </blockquote> <h2>Linear layer</h2> <p>The linear layer is defined as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = Wx + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span> (though we may rearrange the matrices multiplication to match dimensions). We will use <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> to represent the output of the linear layer.</p> <blockquote> <p>I find it more intuitive to do <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>x</mi><mi>W</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = xW + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord">x</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span>, rather than having to do transposing and all that jazz. So I will do that. The actual order of matrix multiplication will depend on how you define dimensions and whatever</p> </blockquote> <p>If we had <em>one training example</em>, our matrix multiplication would look something like this:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>h</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} x_0 &amp; ... &amp; x_{D_{in}} \end{bmatrix} \begin{bmatrix} W_{0, 0} &amp; ... &amp; W_{D_{out}} \\ ... &amp; ... &amp; ... \\ W_{D_{in},0} &amp; ... &amp; W_{D_{in}, D_{out}} \end{bmatrix} + \begin{bmatrix} b_0 &amp; ... &amp; b_{D_{out}} \end{bmatrix} = \begin{bmatrix} h_0 &amp; ... &amp; h_{D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mbin">+</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p> <p>But remember, we typically do training in batches and have multiple examples. Thus, our input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row is one training example, and we have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> examples. Likewise, the output of the layer, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span>, will be a matrix of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row is the output for one example, and we have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> examples.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} h_{0, 0} &amp; ... &amp; h{0, D_{out}} \\ ... \\ h_{N, 0} &amp; ... &amp; h_{N, D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathit mord">h</span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Our weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span> will have dimensions of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{in} \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. We use the same weights for each of our examples.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} W_{0, 0} &amp; ... &amp; W_{D_{out}} \\ ... &amp; W_{i,j} &amp; ... \\ W_{D_{in},0} &amp; ... &amp; W_{D_{in}, D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>If we do the matrix multiplication <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Wx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span></span></span></span>, we get a resultant matrix of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, matching our <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span>. Each row in the output is the result of multipling weights to the corresponding input row.</p> <p>The biases <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">b</span></span></span></span> will have dimensions of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Keep in mind that we use the same bias values for all training examples. So really, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">b</span></span></span></span> is just a vector of with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> columns (just like we showed for the one training example), and expanded along the other dimension to have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> rows, so that we can add our biases to each training example.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} b_0 &amp; ... &amp; b_{D_{out}} \\ ... \\ b_0 &amp; ... &amp; b_{D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Putting it together:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>x</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} x_{0,0} &amp; ... &amp; x_{0,D_{in}} \\ ... \\ x_{N,0} &amp; ... &amp; x_{N,D_{in}} \end{bmatrix} \begin{bmatrix} W_{0, 0} &amp; ... &amp; W_{D_{out}} \\ ... \\ W_{D_{in},0} &amp; ... &amp; W_{D_{in}, D_{out}} \end{bmatrix} + \begin{bmatrix} b_0 &amp; ... &amp; b_{D_{out}} \\ ... \\ b_0 &amp; ... &amp; b_{D_{out}} \end{bmatrix} = \begin{bmatrix} h_{0, 0} &amp; ... &amp; h_{0, D_{out}} \\ ... \\ h_{N, 0} &amp; ... &amp; h_{N, D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mbin">+</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <h2>ReLU layer</h2> <p>ReLU is pretty easy. It's defined as:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">r = max(0, h) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="mrel">=</span><span class="mathit mord">m</span><span class="mathit mord">a</span><span class="mathit mord">x</span><span class="mopen">(</span><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord">h</span><span class="mclose">)</span></span></span></span></span></p> <p>Here, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> is the output from the linear layer being fed into the input of our ReLU layer. And we'll define <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> as the output of our ReLU layer.</p> <p>Essentially, what we're doing is taking <em>every single input</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.980548em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> from our input matrix and running it through our ReLU function, e.g. ensuring every value becomes <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.64444em"></span><span class="bottom strut" style="vertical-align:-.13597em;height:.78041em"></span><span class="base textstyle uncramped"><span class="mrel">≥</span><span class="mathrm mord">0</span></span></span></span>.</p> <p>The dimensions of our input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. ReLU doesn't do any matrix transformations, so it outputs a matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> also.</p> <h2>Softmax layer</h2> <p>Softmax is the final layer of our neural network. Typically, according to Wikipedia, softmax takes in an input vector and outputs a vector of same dimensions. This output vector represents a probability distribution - in our classification model, it represents the predicted probabilities for each class. For each column <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, in the output, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> represents the probability that the training example is part of class <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.65952em"></span><span class="bottom strut" style="vertical-align:0;height:.65952em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span></span></span></span>. And since this is a probability distribution, all the values in the output add up to 1.</p> <p>For <em>one training example</em>, the softmax is defined as:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup></mrow><mrow><msubsup><mo>∑</mo><mi>k</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_i = \frac{e^{r_i}}{\sum_k^{D_{out}} e^{r_k}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.34139em"></span><span class="bottom strut" style="vertical-align:-1.11944em;height:2.46083em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.818131em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.301308em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="margin-right:.05em;top:-.4498em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>The input to softmax is a vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> of size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. The output of softmax will be a vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> of size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> as well.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>S</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">S = \begin{bmatrix} S_0 &amp; ... &amp; S_j &amp; ... &amp; S_{D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.85em"></span><span class="bottom strut" style="vertical-align:-.35001em;height:1.20001em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p> <p>For some math clarification:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mi>k</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><mo>=</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_k^{D_{out}} e^{r_k} = e^{r_0} + e^{r_1} + ... + e^{r_{D_{out}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.30211em;height:3.14645em"></span><span class="base displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.20211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>⇒</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} r_0 &amp; ... &amp; r_{D_{out}} \end{bmatrix} \Rightarrow \begin{bmatrix} \frac{e^{r_0}}{\sum_k e^{r_k}} &amp; ... &amp; \frac{e^{r_{D_{out}}}}{\sum_k e^{r_k}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em"></span><span class="bottom strut" style="vertical-align:-.95003em;height:2.40003em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mrel">⇒</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.072309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.072309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.072309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p> <p>For example, if softmax returned <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn><mn>5</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[0.8, 0.15, 0.05]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">8</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">1</span><span class="mathrm mord">5</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">0</span><span class="mathrm mord">5</span><span class="mclose">]</span></span></span></span>, this means our model predicted that there is an 80% chance that the original input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> (not <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span>) belongs to class index 0, and that there's a 5% chance that the input belongs to class index 2.</p> <p>However, this is just for <em>one training example</em>. To extend this for our model, where we have multiple training examples and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, we can define our softmax as:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_{i, j} = \frac{e^{r_{i, j}}}{\sum_k e^{r_{i, k}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.34139em"></span><span class="bottom strut" style="vertical-align:-.98601em;height:2.3274em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>We are basically taking each row in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> (a vector), and outputting another vector which is another row in our final output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span>. It ends up giving us an output matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row represents the predicted probability distribution for one example.</p> <p>For some math clarification:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup><mo>=</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_k e^{r_{i, k}} = e^{r_{i, 0}} + e^{r_{i, 1}} + ... + e^{r_{i, D_{out}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.05001em"></span><span class="bottom strut" style="vertical-align:-1.30211em;height:2.35212em"></span><span class="base displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.20211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>⇒</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} r_{0, 0} &amp; ... &amp; r_{0, D_{out}} \\ ... \\ r_{N, 0} &amp; ... &amp; r_{N, D_{out}} \end{bmatrix} \Rightarrow \begin{bmatrix} \frac{e^{r_{0, 0}}} {\sum_k e^{r_{0, k}}} &amp; ... &amp; \frac{e^{r_{0, D_{out}}}} {\sum_k e^{r_{0, k}}} \\ \\ ... \\ \\ \frac{e^{r_{N, 0}}} {\sum_k e^{r_{N, k}}} &amp; ... &amp; \frac{e^{r_{0, D_{out}}}} {\sum_k e^{r_{N, k}}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:4.3774em"></span><span class="bottom strut" style="vertical-align:-3.8774em;height:8.2548em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mrel">⇒</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.00504em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:1.85004em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:1.24904em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.648035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.047035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.553965em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.15497em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.75597em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-3.00199em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-3.03601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:2.89139em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.03601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:2.89139em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.03601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:2.89139em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.00504em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:1.85004em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:1.24904em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.648035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.047035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.553965em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.15497em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.75597em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-3.00199em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <h2>Loss function</h2> <p>Softmax is our final layer in our model. It returns a predicted probability distribution for each of our training examples. Now, we need to measure how well our model did.</p> <p>To do that, we will compute the negative log likelihood loss (NLL loss) for each training example. Let's look at only one for now.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mo>[</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn><mn>5</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">S = [0.8, 0.15, 0.05] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mrel">=</span><span class="mopen">[</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">8</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">1</span><span class="mathrm mord">5</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">0</span><span class="mathrm mord">5</span><span class="mclose">]</span></span></span></span></span></p> <p>Typically, our true probability distribution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.625em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span></span></span></span> will look something like this for classification models:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">y = [1, 0, 0] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="mrel">=</span><span class="mopen">[</span><span class="mathrm mord">1</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mclose">]</span></span></span></span></span></p> <p>Interpreting all this, this means that the input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> actually belongs class index 0 (it has 100% chance as shown in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.625em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span></span></span></span>). Our model made a prediction that the input has an 80% chance of being in index 0. So it's almost there.</p> <p>How do we measure how well our model did? We'll calculate a loss value, which is a scalar value. We'll use the NLL loss equation (for one training example):</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>S</mi><mo>)</mo><mo>=</mo><mo>−</mo><msub><mo>∑</mo><mi>c</mi></msub><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mi>c</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(y, S) = -\sum_c y_c log(S_c) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.05001em"></span><span class="bottom strut" style="vertical-align:-1.25001em;height:2.30001em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mopen">(</span><span class="mathit mord" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>It basically sums up the log likelihood for each output feature <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">c</span></span></span></span> (each possible class), and takes the negative. Why negative? Because we want to minimize the total loss.</p> <blockquote> <p>Not gonna explain NLL right now, that's a different story</p> </blockquote> <p>To expand this for multiple training examples, we basically compute the loss <em>for each training example</em>, and output the average loss for all <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> examples:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>S</mi><mo>)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(y, S) = - \frac{1}{N} \sum_{i=0}^N \sum_c^{D_{out}} y_{i, c} log(S_{i, c}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.12201em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mopen">(</span><span class="mathit mord" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>Note that here, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.625em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span></span></span></span> is a matrix of size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, where each row is the true probability distribution for one example.</p> <h2>Minimizing loss</h2> <p>We go forward in our neural network with our initial input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span>, get predicted distributions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> for each traing example, and finally calculate a final loss value <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span> for each training example, and take the average over the batch.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = Wx + b </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">r = max(0, h) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="mrel">=</span><span class="mathit mord">m</span><span class="mathit mord">a</span><span class="mathit mord">x</span><span class="mopen">(</span><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord">h</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mtext><mi mathvariant="normal">S</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mtext><mo>(</mo><mi>r</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">S = \text{Softmax}(r) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mrel">=</span><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">S</span><span class="mathrm mord">o</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mathrm mord">t</span><span class="mathrm mord">m</span><span class="mathrm mord">a</span><span class="mathrm mord">x</span></span><span class="mopen">(</span><span class="mathit mord" style="margin-right:.02778em">r</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>=</mo><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L} = - \frac{1}{N} \sum_{i=0}^N \sum_c^{D_{out}} y_{i, c} log(S_{i, c}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.12201em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mrel">=</span><span class="mord">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>Now it's time to update our parameters (our weights and biases). To do so, we'll calculate the <em>gradient</em> of our loss function with respect to our weights or biases for each of out training examples. Then, we'll take the average gradient and update our weights and biases accordingly.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>=</mo><msub><mi>W</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msub><mi mathvariant="normal">∇</mi><mi>W</mi></msub><msub><mrow><mi mathvariant="script">L</mi></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_{new} = W_{old} - \frac{1}{N} \sum_{i=0}^N \nabla_W \mathcal{L}_i </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.82834em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.10601em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span><span class="mathit mord">e</span><span class="mathit mord" style="margin-right:.02691em">w</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathrm mord">∇</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.13889em">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="vlist"><span style="margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msub><mi mathvariant="normal">∇</mi><mi>b</mi></msub><msub><mrow><mi mathvariant="script">L</mi></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_{new} = b_{old} - \frac{1}{N} \sum_{i=0}^N \nabla_b \mathcal{L}_i </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.82834em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.10601em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span><span class="mathit mord">e</span><span class="mathit mord" style="margin-right:.02691em">w</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathrm mord">∇</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="vlist"><span style="margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p>Let's look at how we'll calculate the gradient for each training example. Recall chain rule:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial W} = \frac {\partial \mathcal{L}}{\partial S} \frac {\partial S}{\partial r} \frac {\partial r}{\partial h} \frac {\partial h}{\partial W} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.686em;height:2.05744em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial b} = \frac {\partial \mathcal{L}}{\partial S} \frac {\partial S}{\partial r} \frac {\partial r}{\partial h} \frac {\partial h}{\partial b} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.686em;height:2.05744em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">b</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">b</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>We'll talk in detail about how we'll derive each of these deriviates <em>for one training example</em>, and how we'll update our parameters with respect to <em>multiple training examples</em>, as we described before.</p> <h2>Loss derivative</h2> <p>Recall our loss function <em>for one training example</em>:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>=</mo><mo>−</mo><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mrow><mi>c</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>c</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L} = - \sum_c^{D_{out}} y_{c} log(S_{c}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.25001em;height:3.09434em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mrel">=</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>We need to calculate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.345em;height:1.22511em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord scriptstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. But, let's observe what this derivative looks like.</p> <p><em>For one training example</em>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> is the input with dimensions of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Our loss function is simply one scalar value. Thus, we need to compute the following:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mn>0</mn></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S} = \begin{bmatrix} \frac {\partial \mathcal{L}}{\partial S_0} &amp; ... &amp; \frac {\partial \mathcal{L}}{\partial S_i} &amp; ... &amp; \frac {\partial \mathcal{L}}{\partial S_{D_{out}}} \\ \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.63478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:1.14622em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.63478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.63478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.63478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.63478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Let's try and solve each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.33011em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord scriptstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac><mo>(</mo><mo>−</mo><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mi>c</mi></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S_i} = \frac {\partial \mathcal{L}}{\partial S_i} (- \sum_c^{D_{out}} y_c log(S_c)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.25001em;height:3.09434em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac><mo>(</mo><mo>−</mo><mo>(</mo><msub><mi>y</mi><mn>0</mn></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mn>0</mn></msub><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mi>i</mi></msub><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>y</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">= \frac {\partial \mathcal{L}}{\partial S_i} (-(y_0 log(S_0) + ... + y_i log(S_i) + ... + y_{D_{out}} log(S_{D_{out}}))) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.836em;height:2.20744em"></span><span class="base displaystyle textstyle uncramped"><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mo>−</mo><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><msub><mi>y</mi><mn>0</mn></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mi>i</mi></msub><mo>)</mo><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><msub><mi>y</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">= -(\frac {\partial \mathcal{L}}{\partial S_{i}} (y_0 log(S_0)) + ... + \frac {\partial \mathcal{L}}{\partial S_i} (y_i log(S_i)) + ... + \frac {\partial \mathcal{L}}{\partial S_{i}} (y_{D_{out}} log(S_{D_{out}}))) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.836em;height:2.20744em"></span><span class="base displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord">−</span><span class="mopen">(</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p> <p>We only care about taking the derivative with respect to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. This means that the derivative of all other terms is 0. Thus, we have:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><mo>−</mo><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S_{i}} = \frac {\partial \mathcal{L}}{\partial S_{i}} (- y_{i} log(S_{i})) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.836em;height:2.20744em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mo>−</mo><mfrac><mrow><msub><mi>y</mi><mrow><mi>i</mi></mrow></msub></mrow><mrow><msub><mi>S</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">= -\frac{y_{i}}{S_{i}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.10756em"></span><span class="bottom strut" style="vertical-align:-.836em;height:1.94356em"></span><span class="base displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>This is the derivative of the loss function with respect to its prediction (softmax) output for one training example. It is a matrix of size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>.</p> <h2>Softmax derivative</h2> <p>For one training example, the output of the softmax function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> is size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. The input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> to our softmax function has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. We would like to compute the following:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial r} = \begin{bmatrix} \frac {\partial S}{\partial r_{0}} &amp; ... &amp; \frac {\partial S}{\partial r_i} &amp; ... &amp; \frac {\partial S}{\partial r_{D_{out}}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em"></span><span class="bottom strut" style="vertical-align:-.95003em;height:2.40003em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.03478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.03478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.03478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.03478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.03478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p> <p>Let's try and solve for each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S}{\partial r_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.33011em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>.</p> <p>As stated before, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> has size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. So really, when computing <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S}{\partial r_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.33011em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>, we're computing another matrix:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mn>0</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial S}{\partial r_{i}} = \begin{bmatrix} \frac {\partial S_{0}}{\partial r_{i}} &amp; ... &amp; \frac {\partial S_j}{\partial r_i} &amp; ... &amp; \frac {\partial S_{D_{out}}}{\partial r_{i}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em"></span><span class="bottom strut" style="vertical-align:-.95003em;height:2.40003em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:.01772em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:.01772em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:.01772em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:.01772em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:.01772em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p> <p>In order for us to compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S}{\partial r_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.33011em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>, we need to compute how each of the components <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.969438em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> changes with respect to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">r_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.58056em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>.</p> <p>In other words, our <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S}{\partial r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.345em;height:1.22511em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span> looks like this:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial r} = \begin{bmatrix} \frac {\partial S_0}{\partial r_{0}} &amp; ... &amp; \frac {\partial S_0}{\partial r_i} &amp; ... &amp; \frac {\partial S_0}{\partial r_{D_{out}}} \\ ... \\ \frac {\partial S_{D_{out}}}{\partial r_{0}} &amp; ... &amp; \frac {\partial S_{D_{out}}}{\partial r_i} &amp; ... &amp; \frac {\partial S_{D_{out}}}{\partial r_{D_{out}}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.16244em"></span><span class="bottom strut" style="vertical-align:-2.66244em;height:5.82488em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:1.80502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:.650015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.049015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.551985em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.79801em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.791em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.72144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.791em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.72144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.791em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:1.72144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.791em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.72144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.791em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:1.72144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:1.80502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:.650015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.049015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.551985em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.79801em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <blockquote> <p>This is also called the Jacobian matrix. I ain't a math expert so I'm not gonna explain it, go read it on <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant">Wikipedia</a></p> </blockquote> <p>Let's compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.998328em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.44833em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.51222em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. Recall our softmax equation for one training example:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>j</mi></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_j = \frac{e^{r_j}}{\sum_k e^{r_k}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.34139em"></span><span class="bottom strut" style="vertical-align:-.98601em;height:2.3274em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <blockquote> <p>I replaced <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.65952em"></span><span class="bottom strut" style="vertical-align:0;height:.65952em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.65952em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.85396em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span> for notation consistency in the current context</p> </blockquote> <p>We solve for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.998328em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.44833em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.51222em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. We use quotient rule:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup><mo>)</mo><mo>(</mo><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><mo>)</mo><mo>−</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><mo>)</mo></mrow><mrow><mo>(</mo><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><msup><mo>)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}} = \frac { (\frac{\partial S_{j}}{\partial r_{i}} e^{r_i}) (\sum_k e^{r_k}) - e^{r_i} \frac {\partial S_{j}}{\partial r_{i}} (\sum_k e^{r_k}) } {(\sum_k e^{r_k})^2} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.83833em"></span><span class="bottom strut" style="vertical-align:-.98601em;height:2.82434em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.84em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.51222em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">−</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.51222em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>Observe that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}} e^{r_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.998328em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.44833em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.51222em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> can depend on whether <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i = j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.65952em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.85396em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span>.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>=</mo><mi>j</mi></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}} e^{r_i} = \begin{cases} e^{r_i} &amp; \text{if }i = j\\ 0 &amp; \text{if }i \neq j \end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em"></span><span class="bottom strut" style="vertical-align:-1.25003em;height:3.00003em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-.682em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:.758em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist"><span style="top:-.682em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span style="top:.758em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">≠</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>This is because in the original equation, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.969438em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> actually only depends on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><msub><mi>r</mi><mi>j</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">e_{r_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.35222em;height:.78278em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Otherwise, its derivative is zero.</p> <p>For <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}} (\sum_k e^{r_k})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.998328em"></span><span class="bottom strut" style="vertical-align:-.45em;height:1.44833em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.51222em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>, its derivative is the same regardless of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.65952em"></span><span class="bottom strut" style="vertical-align:0;height:.65952em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.65952em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.85396em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span>:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><mo>)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>(</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>j</mi></msub></mrow></msup></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>=</mo><mi>j</mi></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>j</mi></msub></mrow></msup></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}} (\sum_k e^{r_k}) = \frac {\partial S_{j}}{\partial r_{i}}(e^{r_0} + ... + e^{r_i} + ... + e^{r_{D_{out}}}) = \begin{cases} e^{r_j} &amp; \text{if }i = j\\ e^{r_j} &amp; \text{if }i \neq j \end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em"></span><span class="bottom strut" style="vertical-align:-1.30211em;height:3.05211em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.20211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mopen">(</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-.682em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:.758em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist"><span style="top:-.682em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span style="top:.758em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">≠</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>After some labor (that I skipped writing about), we arrive to the derivation:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>r</mi><mrow><mi>i</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msub><mi>S</mi><mi>j</mi></msub><mo>⋅</mo><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>S</mi><mi>j</mi></msub><mo>)</mo></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>=</mo><mi>j</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><msub><mi>S</mi><mi>i</mi></msub><msub><mi>S</mi><mi>j</mi></msub></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial S_{j}}{\partial r_{i}} = \begin{cases} S_j \cdot (1 - S_j) &amp; \text{if } i = j \\ -S_i S_j &amp; \text{if }i \neq j \\ \end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.41em"></span><span class="bottom strut" style="vertical-align:-1.91em;height:4.32em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.95001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎩</span></span></span><span style="top:.95001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎪</span></span></span><span style="top:-.00001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎨</span></span></span><span style="top:-1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎪</span></span></span><span style="top:-1.45002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎧</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-1.402em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mopen">(</span><span class="mathrm mord">1</span><span class="mbin">−</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span style="top:.038em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord">−</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.402em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span style="top:.038em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">≠</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <blockquote> <p>If you did this by hand, you'll notice that you can substitute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.969438em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> into your derivations. That's what I did, in case you're confused.</p> </blockquote> <blockquote> <p>Future me, if you don't get this, go back to calc 1 smh</p> </blockquote> <p>In the end, our matrix looks kinda cool with a neat diagonal:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>⋅</mo><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>S</mi><mn>0</mn></msub><mo>)</mo></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mo>−</mo><msub><mi>S</mi><mn>0</mn></msub><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><msub><mi>S</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><mo>⋅</mo><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>S</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial S}{\partial r} = \begin{bmatrix} S_0 \cdot (1 - S_0) &amp; ... &amp; -S_0 S_{D_{out}} \\ ... \\ -S_{D_{out}} S_0 &amp; ... &amp; S_{D_{out}} \cdot (1 - S_{D_{out}}) \\ \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.65201em"></span><span class="bottom strut" style="vertical-align:-2.15003em;height:4.80204em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:1.50501em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:.35001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.25099em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.49701em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.81em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mopen">(</span><span class="mathrm mord">1</span><span class="mbin">−</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span style="top:-.61em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:.59em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord">−</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.79em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.81em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:.59em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.81em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord">−</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:.59em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mopen">(</span><span class="mathrm mord">1</span><span class="mbin">−</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:1.50501em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:.35001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.25099em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.49701em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <h2>ReLU derivative</h2> <p>Just like forward pass, this step is pretty easy. The derivative of ReLU (with respect to each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> element in the input matrix) is:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi>r</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>h</mi><mo>&lt;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>h</mi><mo>≥</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{r}}{\partial h} = \begin{cases} 0 &amp; \text{if }h &lt; 0 \\ 1 &amp; \text{if }h \geq 0 \\ \end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.41em"></span><span class="bottom strut" style="vertical-align:-1.91em;height:4.32em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.95001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎩</span></span></span><span style="top:.95001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎪</span></span></span><span style="top:-.00001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎨</span></span></span><span style="top:-1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎪</span></span></span><span style="top:-1.45002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎧</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-1.402em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span style="top:.038em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">1</span></span></span><span style="top:1.478em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.402em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">h</span><span class="mrel">&lt;</span><span class="mathrm mord">0</span></span></span><span style="top:.038em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">h</span><span class="mrel">≥</span><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <blockquote> <p><a href="https://stackoverflow.com/questions/42042561/relu-derivative-in-backpropagation">stackoverflow</a></p> </blockquote> <h2>Linear derivative</h2> <p>Recall the equation for our linear layer:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = Wx + b </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span></span></p> <p>Recall that, for one training example, the output matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. The input matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, our weights have dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{in} \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, and our biases have dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1 \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathrm mord">1</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>.</p> <p>First, let's compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.345em;height:1.22511em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. We want the following:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>j</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W} = \begin{bmatrix} \frac {\partial h}{\partial W_{0, 0}} &amp; ... &amp; \frac {\partial h}{\partial W_{0, j}} &amp; ... &amp; \frac {\partial h}{\partial W_{0, D_{out}}} \\ \\ ... \\ \\ \frac {\partial h}{\partial W_{i, 0}} &amp; ... &amp; \frac {\partial h}{\partial W_{i, j}} &amp; ... &amp; \frac {\partial h}{\partial W_{j, D_{out}}}\\ \\ ... \\ \\ \frac {\partial h}{\partial W_{D_{in}, 0}} &amp; ... &amp; \frac {\partial h}{\partial W_{D_{in}, j}} &amp; ... &amp; \frac {\partial h}{\partial W_{D_{in}, D_{out}}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:7.36532em"></span><span class="bottom strut" style="vertical-align:-6.86532em;height:14.2306em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:6.00509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:4.85009em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:4.24909em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:3.64809em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:3.04709em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:2.44609em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:1.84509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:1.24409em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.643085em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.042085em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.558915em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.15992em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.76092em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.36192em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.96292em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-3.56392em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-4.16492em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-4.76592em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-6.01194em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-5.99388em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-4.18177em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-2.98177em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-1.78177em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:1.76177em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:2.96177em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:4.16177em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:5.89321em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-5.99388em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:5.89321em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-5.99388em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:5.89321em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-5.99388em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:5.89321em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-5.99388em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.05724em">j</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:5.89321em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:6.00509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:4.85009em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:4.24909em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:3.64809em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:3.04709em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:2.44609em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:1.84509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:1.24409em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.643085em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.042085em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.558915em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.15992em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.76092em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.36192em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.96292em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-3.56392em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-4.16492em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-4.76592em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-6.01194em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>We must also compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W_{i, j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.54722em;height:1.42733em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W_{i, j}} = \begin{bmatrix} \frac {\partial h_0}{\partial W_{i, j}} &amp; ... &amp; \frac {\partial h_k}{\partial W_{i, j}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{i, j}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em"></span><span class="bottom strut" style="vertical-align:-.972108em;height:2.42211em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p> <p>So, our Jacobian matrix looks like this:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mn>0</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W} = \begin{bmatrix} \begin{bmatrix} \frac {\partial h_0}{\partial W_{0, 0}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{0, 0}} \end{bmatrix} &amp; ... &amp; \begin{bmatrix} \frac {\partial h_0}{\partial W_{0, j}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{0, j}} \end{bmatrix} &amp; ... &amp; \begin{bmatrix} \frac {\partial h_0}{\partial W_{0, D_{out}}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{0, D_{out}}} \end{bmatrix} \\ \\ ... \\ \\ \begin{bmatrix} \frac {\partial h_0}{\partial W_{i, 0}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{i, 0}} \end{bmatrix} &amp; ... &amp; \begin{bmatrix} \frac {\partial h_0}{\partial W_{i, j}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{i, j}} \end{bmatrix} &amp; ... &amp; \begin{bmatrix} \frac {\partial h_0}{\partial W_{i, D_{out}}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{i, D_{out}}} \end{bmatrix} \\ \\ ... \\ \\ \begin{bmatrix} \frac {\partial h_0}{\partial W_{D_{in}, 0}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{D_{in}, 0}} \end{bmatrix} &amp; ... &amp; \begin{bmatrix} \frac {\partial h_0}{\partial W_{D_{in}, j}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{D_{in}, j}} \end{bmatrix} &amp; ... &amp; \begin{bmatrix} \frac {\partial h_0}{\partial W_{D_{in}, D_{out}}} &amp; ... &amp; \frac {\partial h_{D_{out}}}{\partial W_{D_{in}, D_{out}}} \end{bmatrix} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:7.46793em"></span><span class="bottom strut" style="vertical-align:-6.95011em;height:14.418em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:6.30509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:5.15009em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:4.54909em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:3.94809em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:3.34709em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:2.74609em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:2.14509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:1.54409em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.94309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.34209em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.25891em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.85991em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.46091em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.06191em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.66291em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-3.26391em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-3.86491em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-4.46591em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-5.06691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-6.31293em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-6.00005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:-4.21002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-3.01002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-1.81002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-.000015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:1.79002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:2.99002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:4.19002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:6.00002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-6.00005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.000015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:6.00002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-6.00005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:-.000015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:6.00002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-6.00005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.000015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:6.00002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-6.00005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:-.000015em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:6.00002em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.050334em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:6.30509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:5.15009em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:4.54909em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:3.94809em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:3.34709em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:2.74609em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:2.14509em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:1.54409em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.94309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.34209em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.25891em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.85991em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.46091em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.06191em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.66291em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-3.26391em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-3.86491em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-4.46591em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-5.06691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-6.31293em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Now, this Jacobian matrix looks a bit weird. It appears to be a 3D matrix. When I first saw this, I had a hard time visualizing this, especially since this is only one training example (which adds another dimension to our matrix 💀). However, as we continue and simplify stuff, rest assured it will be clear.</p> <p>Let's continue and compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial h_k}{\partial W_{i, j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.901968em"></span><span class="bottom strut" style="vertical-align:-.54722em;height:1.44919em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.41586em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. Using basic matrix multiplication knowledge, we can note the equation for a specific <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">h_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.84444em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> component:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub><mo>=</mo><mo>(</mo><msubsup><mo>∑</mo><mi>n</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msubsup><msub><mi>W</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>x</mi><mrow><mi>n</mi></mrow></msub><mo>)</mo><mo>+</mo><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">h_k = (\sum_n^{D_{in}} W_{n, k} x_{n}) + b_k </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.25001em;height:3.09434em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">n</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p>Observe that for computing <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial h_k}{\partial W_{i, j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.901968em"></span><span class="bottom strut" style="vertical-align:-.54722em;height:1.44919em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.41586em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>, when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>≠</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i \neq k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.716em"></span><span class="bottom strut" style="vertical-align:-.215em;height:.931em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span><span class="mrel">≠</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span>, then the derivative is zero. This is because the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">h_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.84444em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> depends on only <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{n, k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.969438em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, as noted in the origianl equation of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">h_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.84444em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Intuitively, it's because during matrix multiplication, only column <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span> in the weights matrix actually affect column <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span> in the final matrix $h.</p> <blockquote> <p>Order of matrix multiplication is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi>W</mi></mrow><annotation encoding="application/x-tex">xW</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span> rather than <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Wx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span></span></span></span>. As said earlier, this is more intuitive for me, especially when we extend it to multiple examples. I just write <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Wx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span></span></span></span> because it's more readable</p> </blockquote> <p>Now, we solve for the other case if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span>. Not gonna show the work here, the derivation is self-explanatory (unless you failed calc 1). We arrive with the final derivation:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>≠</mo><mi>k</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd><mtd><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext> </mtext></mtext><mi>i</mi><mo>=</mo><mi>k</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h_k}{\partial W_{i, j}} = \begin{cases} 0 &amp; \text{if }i \neq k \\ x_i &amp; \text{if }i = k \end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em"></span><span class="bottom strut" style="vertical-align:-1.25003em;height:3.00003em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-.682em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span style="top:.758em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist"><span style="top:-.682em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">≠</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="top:.758em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">i</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mord mspace"> </span></span><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>Very cool. We found <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial h_k}{\partial W_{i, j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.901968em"></span><span class="bottom strut" style="vertical-align:-.54722em;height:1.44919em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.41586em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. Let's zoom out a bit and look at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W_{i, j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.54722em;height:1.42733em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. Say we're looking at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{0, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.969438em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W_{0, 0}} = \begin{bmatrix} x_0 &amp; 0 &amp; ... &amp; 0 \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.972108em;height:2.34355em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p> <p>Another example. Let's say we're looking at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{0, 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.969438em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mn>0</mn></mrow></mtd><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mn>0</mn></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W_{0, 1}} = \begin{bmatrix} 0 &amp; x_0 &amp; ... &amp; 0 \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.972108em;height:2.34355em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p> <p>Essentially, all other values in the matrix where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>≠</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i \neq k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.716em"></span><span class="bottom strut" style="vertical-align:-.215em;height:.931em"></span><span class="base textstyle uncramped"><span class="mathit mord">i</span><span class="mrel">≠</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span> is zero. We knew this already though.</p> <p>Our final Jacobian matrix looks something like this:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial h}{\partial W} = \begin{bmatrix} \begin{bmatrix} x_0 &amp; ... \end{bmatrix} &amp; ... &amp; \begin{bmatrix} ... &amp; x_0 &amp; ... \end{bmatrix} &amp; ... &amp; \begin{bmatrix} ... &amp; x_0 \end{bmatrix} \\ \\ ... \\ \\ \begin{bmatrix} x_i &amp; ... \end{bmatrix} &amp; ... &amp; \begin{bmatrix} ... &amp; x_i &amp; ... \end{bmatrix} &amp; ... &amp; \begin{bmatrix} ... &amp; x_i \end{bmatrix} \\ \\ ... \\ \\ \begin{bmatrix} x_{D_{in}} &amp; ... \end{bmatrix} &amp; ... &amp; \begin{bmatrix} ... &amp; x_{D_{in}} &amp; ... \end{bmatrix} &amp; ... &amp; \begin{bmatrix} ... &amp; x_{D_{in}} \end{bmatrix} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:5.665em"></span><span class="bottom strut" style="vertical-align:-5.165em;height:10.83em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:4.50506em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:3.35006em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:2.74906em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:2.14806em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:1.54706em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.94606em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.34506em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.25594em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.85694em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.45794em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.05894em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.65994em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-3.26094em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-4.50696em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-4.815em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:-3.615em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-2.415em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-1.215em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-.005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:1.195em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:2.395em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:3.595em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:4.805em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-4.815em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:4.805em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-4.815em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:-.005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:4.805em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-4.815em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:4.805em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-4.815em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:-.005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:4.805em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:4.50506em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:3.35006em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:2.74906em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:2.14806em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:1.54706em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.94606em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.34506em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.25594em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.85694em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.45794em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.05894em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.65994em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-3.26094em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-4.50696em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>TODO</p>  <h2>Combining our derivatives together</h2> <p>TODO</p> <h2>Backward pass for multiple examples</h2> <p>TODO</p> <h2>Conclusion</h2> <p>Now we know neural network basic math 😎🎉🎉🎉</p> <img src="https://media1.tenor.com/m/mJ_Og97j5WwAAAAC/chipi-chapa.gif" alt="chipi chipi chapa chapa cat" width="300"> </div> <a class="border-b-2 border-b-transparent border-solid flex flex-row font-semibold hover:border-b-white hover:opacity-60 items-center my-4 text-sm transition w-fit" href="#" title="Back to Top"> <svg class="fill-white" height="1em" viewBox="0 0 384 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2l105.4 105.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg> &nbsp; <span>Back to Top</span> </a> </main> </body></html>