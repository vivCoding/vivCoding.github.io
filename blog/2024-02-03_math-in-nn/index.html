<!doctype html><html lang="en" class="motion-reduce:scroll-auto scroll-smooth"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="robots" content="index, follow"><meta property="og:type" content="website"><meta property="og:title" content="Back to basics: Neural network from scratch | Vincent V"><meta property="og:url" content="https://vivcoding.github.io"><meta property="og:image" content="/up_/assets/images/logo-bg.png"><meta property="og:description" content="For class, I had to implement a neural network from scratch, using only basic PyTorch Tensor operations. It was a great refresher on the math behind a neural network. Though,..."><meta property="twitter:title" content="Back to basics: Neural network from scratch | Vincent V"><meta property="twitter:description" content="For class, I had to implement a neural network from scratch, using only basic PyTorch Tensor operations. It was a great refresher on the math behind a neural network. Though,..."><meta property="twitter:image" content="/assets/images/logo-bg.png"><meta name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/blog/index.183d13f7.css"><link rel="stylesheet" href="/blog/2024-01-12_hello-world/index.964072a6.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><link rel="icon shortcut" type="image/x-icon" href="/logo-bg.02c4c481.svg"><title> Back to basics: Neural network from scratch | Vincent V </title></head><body class="bg-zinc-900 font-sans text-white"> <main class="max-w-4xl mb-10 mx-auto my-4 px-10"> <nav class="mb-10"> <div class="flex flex-row flex-wrap items-center justify-center space-x-4"> <h4 class="font-bold text-center text-lg">Vincent V</h4> <div class="bg-white rounded self-stretch w-[2px]"></div> <a class="border-b-2 border-b-transparent border-solid duration-200 flex flex-row font-semibold hover:border-b-white hover:opacity-60 items-center text-sm transition w-fit" href="/" title="Home"> <svg class="fill-white" height="1em" viewBox="0 0 576 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"/></svg> &nbsp; <span>Home</span> </a> <a class="border-b-2 border-b-transparent border-solid duration-200 flex flex-row font-semibold hover:border-b-white hover:opacity-60 items-center text-sm transition w-fit" href="/blog" title="Blog"> <svg class="fill-white" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="m410.3 231 11.3-11.3-33.9-33.9-62.1-62.1-33.9-33.9-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2l199.2-199.2 22.6-22.7zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9l-78.2 23 23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7l-14.4 14.5-22.6 22.6-11.4 11.3 33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5l-39.3-39.4c-25-25-65.5-25-90.5 0zm-47.4 168-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"/></svg> &nbsp; <span>Blog</span> </a> </div> </nav> <div id="postHeader"> <h1 class="break-words font-bold hyphens-auto mb-0 text-5xl"> Back to basics: Neural network from scratch </h1> <h6 class="italic mt-4 text-sm"> Created: <span class="font-light"> Feb 03, 2024 </span> </h6> <h6 class="italic text-sm"> Updated: <span class="font-light"> Feb 03, 2024 </span> </h6> </div> <div class="border-solid border-y-2 border-y-white max-w-none mt-10 prose prose-invert py-4"> <p>For class, I had to implement a neural network from scratch, using only basic PyTorch Tensor operations. It was a great refresher on the math behind a neural network. Though, that doesn't make implementing and visualizing the math easier.</p> <blockquote> <p>&quot;You're good in math bro, you should learn machine learning bro&quot;</p> </blockquote> <img src="https://media1.tenor.com/m/-URYSckgL9sAAAAd/get-out-of-my-head-meme.gif" alt="cat crazy like me fr" width="200"> <p>I write this to remind my future self on the intuition behind the math in the neural network, in case I want a refresher, or if I ever have to write a neural network from scratch again (when pigs start flying). I won't be discussing what each layer does or why we use certain layers, per se. I wanted to show how we derived the forward and backward passes (<em>especially</em> the backward pass).</p> <h2>Setup</h2> <p>The model we'll describe will be a classification model. It takes in input(s), and outputs a probability distribution describing how likely it is to be a specific class. It will consist of the following layers, in order:</p> <ol> <li>Linear</li> <li>ReLU</li> <li>Softmax</li> </ol> <p>For our loss function, we'll use the negative log likelihood (NLL) function.</p> <blockquote> <p><strong>PLEASE NOTE</strong> that this is for learning purposes. In practice, depending on what you want (say for classification), you may not want ReLU as the last layer.</p> </blockquote> <blockquote> <p>For classification, the cross entropy loss is equivalent to having a softmax layer and using NLL loss. So, you can simplify softmax and NLL loss to be the cross entropy loss function. However, I prefer to keep them separate to make math easier to grasp.</p> </blockquote> <p>Typically, most guides describe the input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> to the model as a vector with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> input features. However, we usually train over multiple examples (a batch size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span>). Thus, in this guide, we'll define our input to our model as a matrix with dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row in the input is one training example.</p> <p>Similarly, our model output will be a <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> matrix, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> represents the number of output features (the number of classes we can predict).</p> <p>With the model's core dimensions defined, let's dive into the specifics of each layer and the forward pass of the neural network.</p> <blockquote> <p>Note, I'll define variables that are probably not very common in other tutorials. Idc. These variables made sense to me when I was first learning it.</p> </blockquote> <h2>Linear layer</h2> <p>The linear layer is defined as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = Wx + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span> (though we may rearrange the matrices multiplication to match dimensions). We will use <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> to represent the output of the linear layer.</p> <blockquote> <p>I find it more intuitive to do <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>x</mi><mi>W</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = xW + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord">x</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span>, rather than having to do transposing and all that jazz. So I will do that. The actual order of matrix multiplication will depend on how you define dimensions and whatever</p> </blockquote> <p>If we had <em>one training example</em>, our matrix multiplication would look something like this:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>h</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} x_0 &amp; ... &amp; x_{D_{in}} \end{bmatrix} \begin{bmatrix} W_{0, 0} &amp; ... &amp; W_{D_{out}} \\ ... &amp; ... &amp; ... \\ W_{D_{in},0} &amp; ... &amp; W_{D_{in}, D_{out}} \end{bmatrix} + \begin{bmatrix} b_0 &amp; ... &amp; b_{D_{out}} \end{bmatrix} = \begin{bmatrix} h_0 &amp; ... &amp; h_{D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mbin">+</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p> <p>But remember, we typically do training in batches and have multiple examples. Thus, our input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row is one training example, and we have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> examples. Likewise, the output of the layer, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span>, will be a matrix of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row is the output for one example, and we have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> examples.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} h_{0, 0} &amp; ... &amp; h{0, D_{out}} \\ ... \\ h_{N, 0} &amp; ... &amp; h_{N, D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathit mord">h</span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Our weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span> will have dimensions of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{in} \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. We use the same weights for each of our examples.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} W_{0, 0} &amp; ... &amp; W_{D_{out}} \\ ... &amp; W_{i,j} &amp; ... \\ W_{D_{in},0} &amp; ... &amp; W_{D_{in}, D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>If we do the matrix multiplication <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Wx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span></span></span></span>, we get a resultant matrix of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, matching our <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span>. Each row in the output is the result of multipling weights to the corresponding input row.</p> <p>The biases <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">b</span></span></span></span> will have dimensions of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Keep in mind that we use the same bias values for all training examples. So really, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">b</span></span></span></span> is just a vector of with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> columns (just like we showed for the one training example), and expanded along the other dimension to have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> rows, so that we can add our biases to each training example.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} b_0 &amp; ... &amp; b_{D_{out}} \\ ... \\ b_0 &amp; ... &amp; b_{D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Putting it together:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>x</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>x</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>W</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>W</mi><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>b</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>h</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} x_{0,0} &amp; ... &amp; x_{0,D_{out}} \\ ... \\ x_{N,0} &amp; ... &amp; x_{N,D_{out}} \end{bmatrix} \begin{bmatrix} W_{0, 0} &amp; ... &amp; W_{D_{out}} \\ ... &amp; W_{i,j} &amp; ... \\ W_{D_{in},0} &amp; ... &amp; W_{D_{in}, D_{out}} \end{bmatrix} + \begin{bmatrix} b_0 &amp; ... &amp; b_{D_{out}} \\ ... \\ b_0 &amp; ... &amp; b_{D_{out}} \end{bmatrix} = \begin{bmatrix} h_{0, 0} &amp; ... &amp; h_{0, D_{out}} \\ ... \\ h_{N, 0} &amp; ... &amp; h_{N, D_{out}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="bottom strut" style="vertical-align:-1.55002em;height:3.60004em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">x</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mathit mord">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mbin">+</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <h2>ReLU layer</h2> <p>ReLU is pretty easy. It's defined as:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">r = max(0, h) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="mrel">=</span><span class="mathit mord">m</span><span class="mathit mord">a</span><span class="mathit mord">x</span><span class="mopen">(</span><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord">h</span><span class="mclose">)</span></span></span></span></span></p> <p>Here, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> is the output from the linear layer being fed into the input of our ReLU layer. And we'll define <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> as the output of our ReLU layer.</p> <p>Essentially, what we're doing is taking <em>every single input</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.286108em;height:.980548em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord">h</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> from our input matrix and running it through our ReLU function, e.g. ensuring every value becomes <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.64444em"></span><span class="bottom strut" style="vertical-align:-.13597em;height:.78041em"></span><span class="base textstyle uncramped"><span class="mrel">≥</span><span class="mathrm mord">0</span></span></span></span>.</p> <p>The dimensions of our input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:0;height:.69444em"></span><span class="base textstyle uncramped"><span class="mathit mord">h</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. ReLU doesn't do any matrix transformations, so it outputs a matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> also.</p> <h2>Softmax layer</h2> <p>Softmax is the final layer of our neural network. We use softmax to make our prediction. For each training example, it returns a probability distribution for our output features (each possible class). More explanation a lil' later.</p> <p>The input to our softmax layer is the output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> from our ReLU layer, which has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>.</p> <p>For <em>one training example</em> (as most tutorials show), the softmax is defined as:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>c</mi></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_i = \frac{e^{r_c}}{\sum_k e^{r_k}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.34139em"></span><span class="bottom strut" style="vertical-align:-.98601em;height:2.3274em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>For clarification:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup><mo>=</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_k e^{r_k} = e^{r_0} + e^{r_1} + ... + e^{r_{D_{out}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.05001em"></span><span class="bottom strut" style="vertical-align:-1.30211em;height:2.35212em"></span><span class="base displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.20211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>⇒</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mn>0</mn></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow></msup></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} r_0 &amp; ... &amp; r_{D_{out}} \end{bmatrix} \Rightarrow \begin{bmatrix} \frac{e^{r_0}}{\sum_k e^{r_k}} &amp; ... &amp; \frac{e^{r_{D_{out}}}}{\sum_k e^{r_k}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em"></span><span class="bottom strut" style="vertical-align:-.95003em;height:2.40003em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span><span class="mrel">⇒</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-.072309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathrm mord">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.072309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-.072309em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.289em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p> <p>Typically, softmax takes in an input vector and outputs a vector of same dimensions. This output vector represents a probability distribution - in our classification model, it represents the predicted probabilities for each class. For each column <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, in the output, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span> represents the probability that the training example is part of class <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">c</span></span></span></span>. And since this is a probability distribution, all the values in the output add up to 1.</p> <p>For example, if softmax returned <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn><mn>5</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[0.8, 0.15, 0.05]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">8</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">1</span><span class="mathrm mord">5</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">0</span><span class="mathrm mord">5</span><span class="mclose">]</span></span></span></span>, this means our model predicted that there is an 80% chance that the original input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> (not <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span>) belongs to class index 0, and that there's a 5% chance that the input belongs to class index 2.</p> <p>However, this is just for <em>one training example</em>. To extend this for our model, where we have multiple training examples and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span> has dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, we can define our softmax as:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_{i, j} = \frac{e^{r_{i, j}}}{\sum_k e^{r_{i, k}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.34139em"></span><span class="bottom strut" style="vertical-align:-.98601em;height:2.3274em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>For clarification:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup><mo>=</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_k e^{r_{i, k}} = e^{r_{i, 0}} + e^{r_{i, 1}} + ... + e^{r_{i, D_{out}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.05001em"></span><span class="bottom strut" style="vertical-align:-1.30211em;height:2.35212em"></span><span class="base displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.20211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mbin">+</span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.413em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>⇒</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></msup></mrow><mrow><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>e</mi><mrow><msub><mi>r</mi><mrow><mi>N</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow></msup></mrow></mfrac></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} r_{0, 0} &amp; ... &amp; r_{0, D_{out}} \\ ... \\ r_{N, 0} &amp; ... &amp; r_{N, D_{out}} \end{bmatrix} \Rightarrow \begin{bmatrix} \frac{e^{r_{0, 0}}} {\sum_k e^{r_{0, k}}} &amp; ... &amp; \frac{e^{r_{0, D_{out}}}} {\sum_k e^{r_{0, k}}} \\ \\ ... \\ \\ \frac{e^{r_{N, 0}}} {\sum_k e^{r_{N, k}}} &amp; ... &amp; \frac{e^{r_{0, D_{out}}}} {\sum_k e^{r_{N, k}}} \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:4.3774em"></span><span class="bottom strut" style="vertical-align:-3.8774em;height:8.2548em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.905em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="mrel">⇒</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.00504em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:1.85004em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:1.24904em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.648035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.047035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.553965em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.15497em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.75597em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-3.00199em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-3.03601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-1.21em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:-.01em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.19em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span style="top:2.89139em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.03601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:2.89139em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-3.03601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:2.89139em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mop"><span class="mop op-symbol small-op" style="top:-.000005em">∑</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.30001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.03148em">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.31083em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.151229em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.03148em">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mathit mord">e</span><span class="vlist"><span style="margin-right:.05em;top:-.363em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.1em;top:.27028em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptscriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:3.00504em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:1.85004em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:1.24904em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.648035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.047035em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.553965em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.15497em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.75597em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-3.00199em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>Running through our softmax layer gives us an output matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> of dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Each row represents the predicted probability distribution for one example. As such, if you sum up all the values in one row, it'll add up to one.</p> <h2>Loss function</h2> <p>Softmax is our final layer in our model. It returns a predicted probability distribution for each of our training examples. Now, we need to measure how well our model did.</p> <p>To do that, we will compute the negative log likelihood loss (NLL loss) for each training example. Let's look at only one for now.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mo>[</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn><mn>5</mn><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">S = [0.8, 0.15, 0.05] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mrel">=</span><span class="mopen">[</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">8</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">1</span><span class="mathrm mord">5</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mathrm mord">.</span><span class="mathrm mord">0</span><span class="mathrm mord">5</span><span class="mclose">]</span></span></span></span></span></p> <p>Typically, our true probability distribution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.625em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span></span></span></span> will look something like this for classification models:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">y = [1, 0, 0] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="mrel">=</span><span class="mopen">[</span><span class="mathrm mord">1</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span><span class="mclose">]</span></span></span></span></span></p> <p>Interpreting all this, this means that the input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span> actually belongs class index 0 (it has 100% chance as shown in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:-.19444em;height:.625em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.03588em">y</span></span></span></span>). Our model made a prediction that the input has an 80% chance of being in index 0. So it's almost there.</p> <p>How do we measure how well our model did? We'll calculate a loss value, which is a scalar value. We'll use the NLL loss equation:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>S</mi><mo>)</mo><mo>=</mo><mo>−</mo><msub><mo>∑</mo><mi>c</mi></msub><msub><mi>y</mi><mi>c</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mi>c</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(y, S) = -\sum_c y_c log(S_c) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.05001em"></span><span class="bottom strut" style="vertical-align:-1.25001em;height:2.30001em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mopen">(</span><span class="mathit mord" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>It basically sums up the log likelihood for each output feature <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">c</span></span></span></span> (each possible class), and takes the negative. Why negative? Because we want to minimize the total loss.</p> <blockquote> <p>Not gonna explain NLL right now, that's a different story</p> </blockquote> <p>To expand this for multiple training examples, we can do something similar:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>S</mi><mo>)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(y, S) = - \frac{1}{N} \sum_{i=0}^N \sum_c^{D_{out}} y_{i, c} log(S_{i, c}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.12201em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mopen">(</span><span class="mathit mord" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>Basically, we calculate the average loss for all <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span> training examples.</p> <h2>Minimizing loss</h2> <p>So we go forward in our neural network with our initial input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="bottom strut" style="vertical-align:0;height:.43056em"></span><span class="base textstyle uncramped"><span class="mathit mord">x</span></span></span></span>, get predicted distributions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span>, and finally calculate a final loss value <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span>.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h = Wx + b </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.08333em;height:.77777em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord">h</span><span class="mrel">=</span><span class="mathit mord" style="margin-right:.13889em">W</span><span class="mathit mord">x</span><span class="mbin">+</span><span class="mathit mord">b</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">r = max(0, h) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.02778em">r</span><span class="mrel">=</span><span class="mathit mord">m</span><span class="mathit mord">a</span><span class="mathit mord">x</span><span class="mopen">(</span><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathit mord">h</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mtext><mi mathvariant="normal">S</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mtext><mo>(</mo><mi>r</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">S = \text{Softmax}(r) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.75em"></span><span class="bottom strut" style="vertical-align:-.25em;height:1em"></span><span class="base displaystyle textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="mrel">=</span><span class="displaystyle mord text textstyle uncramped"><span class="mathrm mord">S</span><span class="mathrm mord">o</span><span class="mathrm mord" style="margin-right:.07778em">f</span><span class="mathrm mord">t</span><span class="mathrm mord">m</span><span class="mathrm mord">a</span><span class="mathrm mord">x</span></span><span class="mopen">(</span><span class="mathit mord" style="margin-right:.02778em">r</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>=</mo><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L} = - \frac{1}{N} \sum_{i=0}^N \sum_c^{D_{out}} y_{i, c} log(S_{i, c}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.12201em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mrel">=</span><span class="mord">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>Now it's time to update our parameters (our weights and biases). To do so, we'll calculate the <em>gradient</em> of our loss function with respect to our weights or biases. Recall chain rule:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial W} = \frac {\partial \mathcal{L}}{\partial S} \frac {\partial S}{\partial r} \frac {\partial r}{\partial h} \frac {\partial h}{\partial W} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.686em;height:2.05744em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.13889em">W</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial b} = \frac {\partial \mathcal{L}}{\partial S} \frac {\partial S}{\partial r} \frac {\partial r}{\partial h} \frac {\partial h}{\partial b} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em"></span><span class="bottom strut" style="vertical-align:-.686em;height:2.05744em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">b</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.02778em">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">b</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span></span></p> <p>Once we have the loss gradient, we can update each of our weights accordingly.</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>=</mo><msub><mi>W</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="normal">∇</mi><mi>W</mi></msub><mrow><mi mathvariant="script">L</mi></mrow></mrow><annotation encoding="application/x-tex">W_{new} = W_{old} - \nabla_W \mathcal{L} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span><span class="mathit mord">e</span><span class="mathit mord" style="margin-right:.02691em">w</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord" style="margin-right:.13889em">W</span><span class="vlist"><span style="margin-left:-.13889em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mathrm mord">∇</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord" style="margin-right:.13889em">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="normal">∇</mi><mi>b</mi></msub><mrow><mi mathvariant="script">L</mi></mrow></mrow><annotation encoding="application/x-tex">b_{new} = b_{old} - \nabla_b \mathcal{L} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.69444em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.84444em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">n</span><span class="mathit mord">e</span><span class="mathit mord" style="margin-right:.02691em">w</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mathit mord">b</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mathrm mord">∇</span><span class="vlist"><span style="margin-left:0;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span></span></p> <p>To do this, we need to calculate each derivative in our chain rule. Let's go through each one.</p> <h2>Loss derivative</h2> <p>Recall our loss function:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>=</mo><mo>−</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mi>c</mi><mrow><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msubsup><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L} = - \frac{1}{N} \sum_{i=0}^N \sum_c^{D_{out}} y_{i, c} log(S_{i, c}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.84434em"></span><span class="bottom strut" style="vertical-align:-1.27767em;height:3.12201em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord textstyle uncramped"><span class="mathcal mord">L</span></span><span class="mrel">=</span><span class="mord">−</span><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.17767em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mrel">=</span><span class="mathrm mord">0</span></span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.25001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="margin-left:0;top:1.15001em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="mathit mord">c</span></span></span><span style="top:-.000005em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span><span class="large-op mop op-symbol">∑</span></span></span><span style="margin-left:0;top:-1.26601em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mord"><span class="mathit mord" style="margin-right:.03588em">y</span><span class="vlist"><span style="margin-left:-.03588em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mathit mord" style="margin-right:.01968em">l</span><span class="mathit mord">o</span><span class="mathit mord" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">i</span><span class="mpunct">,</span><span class="mathit mord">c</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>We need to calculate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.880108em"></span><span class="bottom strut" style="vertical-align:-.345em;height:1.22511em"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.345em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.394em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord scriptstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span></span>. But, let's observe what this derivative looks like.</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:0;height:.68333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span> is an input with dimensions of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N \times D_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="bottom strut" style="vertical-align:-.15em;height:.83333em"></span><span class="base textstyle uncramped"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mbin">×</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>. Our loss function is simply a scalar value. Thus, we need to compute the following matrix:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>S</mi></mrow></mfrac><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mn>0</mn><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>N</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mfrac></mrow></mtd><mtd><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="script">L</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>S</mi><mrow><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac {\partial \mathcal{L}}{\partial S} = \begin{bmatrix} \frac {\partial \mathcal{L}}{\partial S_{0, 0}} &amp; ... &amp; \frac {\partial \mathcal{L}}{\partial S_{0, D_{out}}} \\ ... \\ \frac {\partial \mathcal{L}}{\partial S_{N, 0}} &amp; ... &amp; \frac {\partial \mathcal{L}}{\partial S_{N, D_{out}}} \\ \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.79355em"></span><span class="bottom strut" style="vertical-align:-3.29355em;height:7.0871em"></span><span class="base displaystyle textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mathit mord" style="margin-right:.05764em">S</span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span><span class="mrel">=</span><span class="displaystyle minner textstyle uncramped"><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:2.40503em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎣</span></span></span><span style="top:1.25003em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.649025em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:.048025em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-.552975em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-1.15398em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎢</span></span></span><span style="top:-2.4em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎡</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-2.42211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:-.61em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.12144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mathrm mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:2.93355em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-2.42211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span style="top:1.12144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="mathrm mord">.</span><span class="mathrm mord">.</span><span class="mathrm mord">.</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist"><span style="top:-2.42211em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathrm mord">0</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span style="top:1.12144em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="displaystyle mord textstyle uncramped"><span class="displaystyle mord reset-textstyle textstyle uncramped"><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle textstyle"><span class="cramped mord textstyle"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mathit mord" style="margin-right:.05764em">S</span><span class="vlist"><span style="margin-left:-.05764em;margin-right:.05em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-textstyle scriptstyle"><span class="cramped mord scriptstyle"><span class="mathit mord" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mord"><span class="mathit mord" style="margin-right:.02778em">D</span><span class="vlist"><span style="margin-left:-.02778em;margin-right:.0714286em;top:.15em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="cramped reset-scriptstyle scriptscriptstyle"><span class="cramped mord scriptscriptstyle"><span class="mathit mord">o</span><span class="mathit mord">u</span><span class="mathit mord">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span><span style="top:-.23em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="frac-line reset-textstyle textstyle uncramped"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mathrm mord" style="margin-right:.05556em">∂</span><span class="mord textstyle uncramped"><span class="mathcal mord">L</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span><span class="nulldelimiter reset-size5 reset-textstyle size5 sizing textstyle uncramped"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span><span class="reset-textstyle style-wrap textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:2.40503em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎦</span></span></span><span style="top:1.25003em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.649025em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:.048025em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-.552975em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-1.15398em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎥</span></span></span><span style="top:-2.4em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="delim-size4 delimsizinginner"><span>⎤</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span></span></span></span></p> <p>TODO</p> <h2>Softmax derivative</h2> <p>TODO</p> <h2>ReLU derivative</h2> <p>TODO</p> <h2>Linear derivative</h2> <p>TODO</p> <h2>Conclusion</h2> <p>Now we know neural network basic math 😎🎉🎉🎉</p> <img src="https://media1.tenor.com/m/mJ_Og97j5WwAAAAC/chipi-chapa.gif" alt="chipi chipi chapa chapa cat" width="300"> </div> <a class="border-b-2 border-b-transparent border-solid flex flex-row font-semibold hover:border-b-white hover:opacity-60 items-center my-4 text-sm transition w-fit" href="#" title="Back to Top"> <svg class="fill-white" height="1em" viewBox="0 0 384 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2l105.4 105.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg> &nbsp; <span>Back to Top</span> </a> </main> </body></html>